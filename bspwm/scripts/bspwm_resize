#!/usr/bin/env dash

# Script para redimensionar ventanas en bspwm
# Usa diferentes pasos según si la ventana está flotando (20px) o en mosaico (100px)

# Verifica si la ventana actualmente enfocada está en estado flotante
if /usr/bin/bspc query -N -n focused.floating > /dev/null; then
    step=20  # Paso pequeño para ajustes finos en ventanas flotantes
else
    step=100 # Paso grande para ventanas en modo mosaico (tiled)
fi

# Asigna parámetros según la dirección de redimensionamiento
case "$1" in
    west)   # Redimensionar borde izquierdo
        dir=right    # Intenta primero mover el borde derecho
        falldir=left # Fallback: mover el borde izquierdo si el derecho falla
        x="-$step"   # Reduce el ancho (mueve hacia la izquierda)
        y=0
        ;;
    east)   # Redimensionar borde derecho
        dir=right    # Intenta primero mover el borde derecho
        falldir=left # Fallback: mover el borde izquierdo
        x="$step"    # Aumenta el ancho (mueve hacia la derecha)
        y=0
        ;;
    north)  # Redimensionar borde superior
        dir=top      # Intenta primero mover el borde superior
        falldir=bottom # Fallback: mover el borde inferior
        x=0
        y="-$step"   # Reduce la altura (mueve hacia arriba)
        ;;
    south)  # Redimensionar borde inferior
        dir=top      # Intenta primero mover el borde superior
        falldir=bottom # Fallback: mover el borde inferior
        x=0
        y="$step"    # Aumenta la altura (mueve hacia abajo)
        ;;
esac

# Ejecuta el redimensionamiento
# Primero intenta con la dirección principal, si falla usa la dirección alternativa
/usr/bin/bspc node -z "$dir" "$x" "$y" || /usr/bin/bspc node -z "$falldir" "$x" "$y"
